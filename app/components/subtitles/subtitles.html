<md-content layout="column" style="height:calc(100vh - 4em)">
    <div layout="row" style="height:calc(100% - 3rem)">
        <section ng-hide="vm.movieId == ''" flex="20" layout="column">
            <md-toolbar>
                <div class="md-toolbar-tools">
                    <span flex></span>
                    <md-button class="md-raised" aria-label="Project openen / starten" ng-click="vm.openProjects()">
                        Nieuw / Open
                    </md-button>
                    <span flex></span>
                </div>
            </md-toolbar>
            <md-list style="overflow-y: scroll;">
                <md-list-item class="md-2-line animate-repeat" ng-click="vm.selectSub(c.$id, c.start, c.end); vm.loop = true" ng-class="c.$id == vm.selectedSub.id ? 'list__item--selected' : ''" ng-repeat="(key, c) in vm.clips | orderBy: 'start'">
                    <div class="md-list-item-text">
                        <h3>{{c.start | limitTo: 5}} - {{c.end | limitTo: 5}}</h3>
                        <p>{{ c.text | limitTo: 20 }}{{c.text.length > 20 ? '...' : ''}}
                        </p>
                    </div>
                    <md-button class="md-secondary md-icon-button" ng-click="vm.clips.$remove(c)" aria-label="remove clip">
                        <i class="material-icons" ng-click="vm.clips.$remove(c)">close</i>
                    </md-button>
                </md-list-item>
            </md-list>
            <md-button ng-if="vm.meta.movieUrl != null" class="md-raised" aria-label="Clip toevoegen" ng-click="vm.addSubtitle(vm.meta.movieDuration)">
                Nieuwe ondertitel
            </md-button>
        </section>
        <section ng-if="vm.meta.movieUrl != null" layout-padding flex="40">
            <div ng-repeat="(key, c) in vm.clips" ng-if="c.$id == vm.selectedSub.id">
                <md-input-container class="md-block">
                    <label>Ondertitel text</label>
                    <textarea vrt-maxlines="2" maxlines-prevent-enter="true" id="subtitleText" name="title" ng-model="c.text" ng-change="vm.clips.$save(c)"></textarea>
                </md-input-container>
                <div layout="row">
                    <md-input-container flex="50">
                        <label>Begintijd</label>
                        <input type="text" ng-model="c.start" ng-model-options="{ updateOn: 'default', debounce: { 'default': 1000 } }">
                    </md-input-container>
                    <md-input-container flex="50">
                        <label>Eindtijd</label>
                        <input type="text" ng-model="c.end" ng-model-options="{ updateOn: 'default', debounce: { 'default': 1000 } }">
                    </md-input-container>
                </div>
            </div>
        </section>
        <section flex ng-if="vm.movieActive == true" class="subtitles-movie" layout="column" flex="40">
            <md-list>
                <md-list-item ng-if="!vm.uploading && vm.meta.movieUrl != null">
                    <p>Huidig filmpje: {{vm.meta.movieUrl | limitTo: 30}}{{vm.meta.movieUrl > 30 ? '...' : ''}}</p>
                    <md-button class="md-raised" aria-label="Plaats nieuw filmpje" ng-model="vm.subtitle.video" ngf-accept="'video/mp4, video/quicktime'" ngf-select="vm.upload($file)" type="file">
                        Verander
                    </md-button>
                </md-list-item>
                <div class="videowrapper" ng-if="!vm.uploading && vm.meta.movieUrl != null">
                    <vrt-videoplayer source="vm.meta.movieUrl" start="vm.selectedSub.start" end="vm.selectedSub.end" loop="vm.loop" subs="vm.clips"></vrt-videoplayer>
                </div>
                <md-list-item ng-if="!vm.uploading && vm.meta.movieUrl == null">
                    <md-button class="md-raised" aria-label="Plaats nieuw filmpje" ng-model="vm.subtitle.video" ngf-accept="'video/mp4, video/quicktime'" ngf-select="vm.upload($file)" type="file">
                        Voeg een video toe
                    </md-button>
                </md-list-item>
                <md-list-item ng-if="vm.uploading">
                    <md-progress-linear md-mode="indeterminate"></md-progress-linear>
                </md-list-item>
            </md-list>
            <md-toolbar ng-if="vm.meta.movieUrl != null">
                <div class="md-toolbar-tools">
                    <md-button class="md-raised" aria-label="Bekijk filmpje" ng-click="vm.preview()" ng-disabled="!vm.loop">
                        Preview filmpje
                    </md-button>
                    <span flex></span>
                    <md-button class="md-raised" aria-label="Maak filmpje" ng-click="vm.finishMovie()">
                        Maak filmpje
                    </md-button>
                </div>
            </md-toolbar>
        </section>
    </div>
    <section ng-if="vm.meta.movieUrl != null" layout="row">
        <div flex="70" layout-align="center center" ng-repeat="(key, c) in vm.clips" ng-if="c.$id == vm.selectedSub.id" class="clipSlider" style="width: 100%;position: fixed;bottom: 20px;left: calc(15% - 1px); background-color: transparent; z-index: 3;" ng-class="vm.loop ? '' : 'videoLooping'">
            <rzslider rz-slider-model="c.start" rz-slider-high="c.end" rz-slider-options="vm.clipSlider.options"></rzslider>
        </div>
    </section>
</md-content>
