<md-content layout="column" style="height:calc(100vh - 4em)">
    <div layout="row" style="height:calc(100% - 10rem)">
        <section ng-hide="vm.movieId == ''" flex="20" layout="column">
            <md-toolbar>
                <div class="md-toolbar-tools">
                    <span flex></span>
                    <md-button class="md-raised" aria-label="Project openen / starten" ng-click="vm.openProjects()">
                        Nieuw / Open
                    </md-button>
                    <!-- fill up the space between left and right area -->
                    <span flex></span>
                </div>
            </md-toolbar>
            <md-list style="overflow: scroll;">
                <md-list-item class="md-2-line animate-repeat" ng-click="vm.selectSub(c.$id, c.start, c.end);" ng-class="c.$id == vm.selectedSub.id ? 'list__item--selected' : ''" ng-repeat="(key, c) in vm.clips | orderBy: 'start'" ng-if="c.$id != 'meta'">
                    <div class="md-list-item-text">
                        <h3>{{c.start | limitTo: 5}} - {{c.end | limitTo: 5}}</h3>
                        <p>{{ c.text | limitTo: 20 }}{{c.text.length > 20 ? '...' : ''}}
                        </p>
                    </div>
                    <md-button class="md-secondary md-icon-button" ng-click="vm.clips.$remove(c)" aria-label="remove clip">
                        <i class="material-icons" ng-click="vm.clips.$remove(c)">close</i>
                    </md-button>
                </md-list-item>
            </md-list>
            <md-button ng-if="vm.meta.movieUrl" class="md-raised" aria-label="Clip toevoegen" ng-click="vm.addSubtitle(vm.meta.movieDuration)">
                Nieuwe ondertitel
            </md-button>
        </section>
        <section ng-if="vm.meta.movieUrl != ''" layout-padding flex="40">
            <div ng-repeat="(key, c) in vm.clips" ng-if="c.$id == vm.selectedSub.id">
                <md-input-container class="md-block">
                    <label>Ondertitel text</label>
                    <textarea vrt-maxlines="2" maxlines-prevent-enter="true" id="subtitleText" name="title" ng-model="c.text" ng-change="vm.clips.$save(c)"></textarea>
                </md-input-container>
                <div layout="row">
                    <md-input-container flex="50">
                        <label>Begintijd</label>
                        <input type="text" ng-model="c.start" ng-model-options="{ updateOn: 'default', debounce: { 'default': 1000 } }">
                    </md-input-container>
                    <md-input-container flex="50">
                        <label>Eindtijd</label>
                        <input type="text" ng-model="c.end" ng-model-options="{ updateOn: 'default', debounce: { 'default': 1000 } }">
                    </md-input-container>
                </div>
            </div>
        </section>
        <section flex ng-if="vm.movieActive == true" class="subtitles-movie" layout="column" flex="40">
            <md-list>
                <md-list-item ng-if="!vm.uploading && vm.meta.movieUrl != null">
                    <p>Huidig filmpje: {{vm.meta.movieUrl | limitTo: 30}}{{vm.meta.movieUrl > 30 ? '...' : ''}}</p>
                    <md-button class="md-raised" aria-label="Plaats nieuw filmpje" ng-model="vm.subtitle.video" ngf-accept="'video/mp4, video/quicktime'" ngf-select="vm.upload($file)" type="file">
                        Verander
                    </md-button>
                </md-list-item>
                <md-list-item ng-if="!vm.uploading && vm.meta.movieUrl != null">
                    <div class="videowrapper">
                        <vrt-videoplayer source="vm.meta.movieUrl" start="vm.selectedSub.start" end="vm.selectedSub.end" update-time="vm.updateTime($currentTime, $duration)" loop="vm.loop"></vrt-videoplayer>
                        <div class="subtitles-preview__line" ng-repeat="(key, c) in vm.clips" ng-if="(vm.videogular.api.currentTime/1000) >= c.start && (vm.videogular.api.currentTime/1000) <= (c.start + c.end) && key != 'meta'">
                            <p id="subtitlePreview">{{c.text}}</p>
                        </div>
                    </div>
                </md-list-item>
                <BR/>
                <md-list-item ng-if="!vm.uploading && vm.meta.movieUrl == null">
                    <md-button class="md-raised" aria-label="Plaats nieuw filmpje" ng-model="vm.subtitle.video" ngf-accept="'video/mp4, video/quicktime'" ngf-select="vm.upload($file)" type="file">
                        Voeg een video toe
                    </md-button>
                </md-list-item>
                <md-list-item ng-if="vm.uploading">
                    <md-progress-linear md-mode="indeterminate"></md-progress-linear>
                </md-list-item>
            </md-list>
            {{}}
            <md-toolbar ng-if="vm.meta.movieUrl != null">
                <div class="md-toolbar-tools">
                    <span flex></span>
                    <md-button class="md-raised" aria-label="Maak filmpje" ng-click="vm.finishMovie()">
                        Maak filmpje
                    </md-button>
                    <span flex></span>
                </div>
            </md-toolbar>
        </section>
    </div>
    {{vm.meta.movieUrl == ''}} {{vm.meta.movieUrl == null}} {{vm.meta.movieUrl == undefined}} {{vm.meta.movieUrl == 'undefined'}}
    <section ng-if="vm.meta.movieUrl != null" layout="row" layout-padding style="max-height:10rem;">
        <div ng-click="vm.playPausePlayer()" layout="column" layout-align="center center" flex="5">
            <ng-include src="'assets/iconIncludes/play.html'" layout-align="center center" class="subtitles-controls__icon" ng-if="!vm.playingVideo"></ng-include>
            <ng-include src="'assets/iconIncludes/pause.html'" layout-align="center center" class="subtitles-controls__icon" ng-if="vm.playingVideo"></ng-include>
        </div>
        <div layout="column" flex="90" layout-align="center center">
            <rzslider rz-slider-model="vm.currentTime" rz-slider-options="vm.timeSlider.options"></rzslider>
            <div ng-repeat="(key, c) in vm.clips" ng-if="c.$id == vm.selectedSub.id" class="clipSlider" style="width:100%;" ng-class="vm.loop ? '' : 'videoLooping'">
                <rzslider rz-slider-model="c.start" rz-slider-high="c.end" rz-slider-options="vm.clipSlider.options"></rzslider>
            </div>
        </div>
        <div layout="column" layout-align="center center" flex="5">
            <ng-include src="'assets/iconIncludes/loop.html'" ng-click="vm.toggleLoop()" ng-class="vm.loop ? '' : 'videoLooping'" layout-align="center center" class="subtitles-controls__icon"></ng-include>
        </div>
    </section>
</md-content>
